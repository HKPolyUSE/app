import{c as _e,j as e,r as a}from"./client-B_pnGUEq.js";const U=20,Z=[{name:"Micro Instance",capacity:80,cpu:4,ram:16,upgradeCost:0,maintenance:600},{name:"Standard Instance",capacity:160,cpu:8,ram:32,upgradeCost:2e3,maintenance:1500},{name:"Performance Instance",capacity:320,cpu:16,ram:64,upgradeCost:4e3,maintenance:3500}],we=2,Ne=3,Ge=.85,Se=5e3;function ye(){return 30}function Pe(s){return 10+Math.floor(s/5)}function We({gameOverReason:s,downtime:b,crashes:x,satisfaction:p,budget:c}){return s==="budget"?{title:"üí∏ Bankrupt",desc:"Operational costs exceeded your revenue.",color:"text-red-700"}:b<=3&&x===0&&p>=.9&&c>6e4?{title:"üåü Tech Unicorn",desc:"Superb scaling and massive profits!",color:"text-green-800"}:b<=6&&x<=1&&p>=.8&&c>2e4?{title:"üëç Solid Success",desc:"Minimal downtime and satisfied users.",color:"text-blue-700"}:{title:"üòê Survivor",desc:"You kept the lights on, but it was a rocky road.",color:"text-yellow-700"}}function Ve(s){return s<.7?180+Math.round(40*s):s<.9?210+Math.round(240*(s-.7)/.2):s<=1?450+Math.round(550*(s-.9)/.1):2e3+Math.round(3e3*(s-1))}const Ye=450,qe=.6;function B({title:s,children:b,onClose:x,icon:p,footer:c}){return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-[100] bg-black bg-opacity-40 backdrop-blur-sm p-4",children:e.jsx("div",{className:"bg-white rounded-3xl shadow-2xl max-w-lg w-full overflow-hidden animate-fadein border border-slate-100",children:e.jsxs("div",{className:"p-8 text-center",children:[p&&e.jsx("div",{className:"text-5xl mb-4",children:p}),e.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:s}),e.jsx("div",{className:"text-slate-600 mb-6",children:b}),c||e.jsx("button",{onClick:x,className:"w-full py-3 bg-slate-900 text-white rounded-2xl font-bold hover:bg-slate-800 transition-all shadow-md active:scale-[0.98]",children:"Continue"})]})})})}function Qe(){const[s,b]=a.useState(1),[x,p]=a.useState(0),[c,H]=a.useState(0),[m,ee]=a.useState(!1),[F,_]=a.useState(0),[h,te]=a.useState(1),[j,se]=a.useState(ye()),[G,$]=a.useState([]),[ke,ae]=a.useState(!1),[Ce,le]=a.useState(!1),[Me,I]=a.useState(!1),[ne,S]=a.useState(0),[re,oe]=a.useState(0),[y,P]=a.useState(Se),[Xe,W]=a.useState(0),[ze,ie]=a.useState(0),[T,V]=a.useState(null),[E,ce]=a.useState(100),[Re,de]=a.useState(0),xe=a.useRef(null);a.useEffect(()=>{var t;(t=xe.current)==null||t.scrollIntoView({behavior:"smooth"})},[G]);const he=Z[x],{capacity:ue,cpu:pe,ram:me,maintenance:fe}=he,o=j/ue,v=Ve(o),Ue=x+1,d=Z[Ue],Y=d==null?void 0:d.upgradeCost,$e=Y===void 0||y>=Y,Ie=m&&F>0,be=m&&F===0,q=c>0,l=q||m,Q=s>U||!!T||s>1&&j<=0,Te=()=>{be&&(_(Ne),$(t=>[...t,{type:"recover",text:`Round ${s} ‚Äî üîÑ Reboot initiated (${Ne} rounds)...`}]))},Ee=()=>{if(Q)return;if(s===U){V("finished");return}let t=1,f=!1;s===9&&h>=.85&&(t=2,f=!0);let He=l?0:Pe(s)*t,k=j+He,u=0,w="",C="info";l?(u=Math.ceil(k*(.06+Math.random()*.04)),w=`${u} users left while site was offline.`,C="warnslow"):o>=1?(u=Math.ceil(k*.2),w="System overloaded! 20% of users left.",C="warnover"):v>Ye?(u=Math.ceil(k*((o-.9)*2+.05)),w=`${u} users lost to slowness.`,C="warnslow"):h<qe&&(u=Math.ceil((1-h)*.15*k),w=u>0?`${u} users quit due to low satisfaction.`:"",C="warndissat");let M=Math.max(0,k-u),z=M/ue,L=(l?0:M*25)-fe,J=y+L,n=h,g=[],D=c,K=m,N=F,ve=!1,O=!l&&z>Ge?Re+1:0,i=E;O>=2?i=Math.max(0,i-O*12):!l&&z<.7&&(i=Math.min(100,i+15));const Fe=(100-i)/110;!l&&(Math.random()<Fe||z>1.25)&&(K=!0,N=0,i=Math.max(0,i-30),n=Math.max(0,n-.25),g.push({type:"crash",text:"üî• CRITICAL FAILURE! Sustained load broke the system. MANUAL RESTART REQUIRED."}),S(r=>r+1),oe(r=>r+1),ve=!0,O=0),c>0?(D--,n=Math.max(0,n-.09),g.push({type:"downtime",text:`Downtime: scaling... (${D} rounds left)`}),D===0&&g.push({type:"recover",text:"Scaling complete! System online."}),S(r=>r+1),i=Math.min(100,i+5)):m&&(N>0?(N--,n=Math.max(0,n-.14),g.push({type:"crash",text:`Downtime: Rebooting... (${N} rounds left)`}),N===0&&(K=!1,g.push({type:"recover",text:"Reboot finished! System online."}),i=60)):(n=Math.max(0,n-.18),g.push({type:"crash",text:"System is offline. Restart required."})),S(r=>r+1)),!l&&!ve&&(v>950?n=Math.max(0,n-.11):v>700?n=Math.max(0,n-.07):v>450&&(n=Math.max(0,n-.03))),n=Math.min(1,Math.max(0,Math.round(n*100)/100));let A=null;J<0?(J=0,A="budget"):M<=0&&s>1&&(A="no-users");let R=[{type:"normal",text:`Round ${s} ‚Äî Users: ${j} ‚Üí ${M} (Net: ${L>=0?"+":""}$${L})`}];f&&(R.push({type:"recover",text:"üöÄ Viral Success!"}),le(!0)),w&&R.push({type:C,text:w}),R=R.concat(g.map(r=>({...r,type:r.type||"info"}))),b(r=>r+1),se(M),H(D),ee(K),_(N),te(n),P(J),W(L),ce(i),de(O),$(r=>[...r,...R]),A&&V(A)},Le=()=>{je&&(H(we),p(t=>t+1),ie(t=>t+1),P(t=>t-Y),W(0),$(t=>[...t,{type:"downtime",text:`Round ${s} ‚Äî ‚¨ÜÔ∏è Scaling to Tier ${x+2}.`}]),S(t=>t+1))},ge=()=>{b(1),p(0),H(0),ee(!1),_(0),te(1),se(ye()),$([]),S(0),oe(0),P(Se),W(0),ie(0),ce(100),de(0),V(null)},De=h>=.85?"üü¢":h>=.6?"üòê":"üò°",Oe=m?"üî•":c?"‚è≥":o>.85?"‚ö†Ô∏è":"‚úÖ",Ae=Ie?"Rebooting":m?"Down":q?"Scaling":o>.85?"High Load":"Stable",Be=E>70?"text-green-600":E>30?"text-yellow-600":"text-red-600",je=x<Z.length-1&&!l&&!Q&&$e,X=We({gameOverReason:T,downtime:ne,crashes:re,satisfaction:h,budget:y});return e.jsxs("div",{className:"h-screen w-full flex flex-col items-center justify-center bg-slate-50 p-2 sm:p-4 font-sans text-slate-900 overflow-hidden",children:[Ce&&e.jsx(B,{title:"üöÄ Viral Surge!",icon:"üìà",onClose:()=>le(!1),children:"Growth for Round 10 was doubled due to high satisfaction!"}),Me&&d&&e.jsx(B,{title:"Scale Up Instance",icon:"‚¨ÜÔ∏è",onClose:()=>I(!1),footer:e.jsxs("div",{className:"flex gap-3 w-full",children:[e.jsx("button",{onClick:()=>I(!1),className:"flex-1 py-4 bg-slate-100 text-slate-600 rounded-2xl font-bold hover:bg-slate-200 transition-all active:scale-[0.98]",children:"Cancel"}),e.jsx("button",{onClick:()=>{Le(),I(!1)},className:"flex-1 py-4 bg-pink-600 text-white rounded-2xl font-bold hover:bg-pink-700 transition-all shadow-md active:scale-[0.98]",children:"Confirm Upgrade"})]}),children:e.jsxs("div",{className:"text-sm space-y-4 text-left",children:[e.jsxs("p",{children:["You are about to upgrade your server to a ",e.jsx("b",{children:d.name}),"."]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 bg-slate-50 p-4 rounded-2xl border border-slate-100",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-black",children:"Capacity"}),e.jsxs("span",{className:"font-bold",children:[d.capacity," Users"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-black",children:"Op. Cost"}),e.jsxs("span",{className:"font-bold text-rose-500",children:["-$",d.maintenance,"/rd"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-black",children:"Upgrade Cost"}),e.jsxs("span",{className:"font-bold text-indigo-600",children:["$",d.upgradeCost]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-black",children:"Hardware"}),e.jsxs("span",{className:"font-bold",children:[d.cpu,"vCPU, ",d.ram,"GB"]})]})]}),e.jsxs("div",{className:"bg-amber-50 p-4 rounded-2xl border border-amber-100 flex items-start gap-3",children:[e.jsx("span",{className:"text-xl",children:"‚ö†Ô∏è"}),e.jsxs("p",{className:"text-amber-800 font-medium text-xs leading-relaxed",children:[e.jsx("b",{children:"DOWNTIME WARNING:"})," Scaling will take ",e.jsxs("b",{children:[we," rounds"]}),". Your web app and database will be completely offline, incurring user churn and zero profit."]})]})]})}),T&&e.jsxs(B,{title:"Simulation Result",icon:T==="budget"?"üí∏":"üèÜ",onClose:ge,children:[e.jsx("div",{className:`text-xl font-bold mb-2 ${X.color}`,children:X.title}),e.jsxs("p",{className:"mb-4 text-sm italic",children:['"',X.desc,'"']}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-left bg-slate-50 p-4 rounded-2xl text-sm border border-slate-100",children:[e.jsxs("div",{children:["Final Users: ",e.jsx("b",{children:Math.round(j)})]}),e.jsxs("div",{children:["Final Budget: ",e.jsxs("b",{children:["$",Math.round(y).toLocaleString()]})]}),e.jsxs("div",{children:["Satisfaction: ",e.jsxs("b",{children:[(h*100).toFixed(0),"%"]})]}),e.jsxs("div",{children:["Downtime: ",e.jsxs("b",{children:[ne," rds"]})]})]})]}),ke&&e.jsx(B,{title:"System Handbook",onClose:()=>ae(!1),children:e.jsxs("div",{className:"text-left text-xs space-y-2 leading-relaxed",children:[e.jsxs("p",{children:["‚Ä¢ ",e.jsx("span",{className:"font-bold",children:"Scaling State:"})," While scaling, the system is offline. ",e.jsx("span",{className:"font-bold",children:"Utilization"})," and ",e.jsx("span",{className:"font-bold",children:"Stability"})," readouts are unavailable."]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("span",{className:"font-bold",children:"Utilization Buffer:"})," System handles one round above 85% load. After that, ",e.jsx("span",{className:"text-rose-500 font-bold",children:"Stability"})," drains."]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("span",{className:"font-bold",children:"Colocated Architecture:"})," App and DB share the same host resources."]})]})}),e.jsxs("div",{className:"flex flex-col w-full max-w-6xl h-full max-h-[900px] bg-white border border-slate-200 rounded-[2.5rem] shadow-xl overflow-hidden",children:[e.jsxs("header",{className:"flex-shrink-0 p-4 sm:px-8 border-b bg-white flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-lg font-black tracking-tight text-slate-800 uppercase",children:"Infra-Scaler v2"}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Vertical Stack Sim"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ae(!0),className:"h-9 px-3 rounded-lg border border-slate-200 text-slate-500 hover:bg-slate-50 text-xs font-bold transition-all",children:"Manual"}),e.jsx("button",{onClick:Ee,className:"h-9 px-5 bg-indigo-600 text-white rounded-lg font-bold hover:bg-indigo-700 disabled:opacity-20 transition-all shadow-sm",disabled:Q,children:s===U?"Results":"Run Round"}),be?e.jsx("button",{onClick:Te,className:"h-9 px-5 bg-orange-500 text-white rounded-lg font-bold hover:bg-orange-600 transition-all animate-pulse shadow-md",children:"Restart"}):e.jsx("button",{onClick:()=>I(!0),className:"h-9 px-5 bg-pink-600 text-white rounded-lg font-bold hover:bg-pink-700 disabled:opacity-20 transition-all shadow-md",disabled:!je,children:"Scale Up"}),e.jsx("button",{onClick:ge,className:"h-9 w-9 flex items-center justify-center bg-slate-100 text-slate-400 rounded-lg hover:bg-slate-200 transition-all",children:"‚Ü∫"})]})]}),e.jsxs("main",{className:"flex-1 flex flex-col md:flex-row overflow-hidden border-b border-slate-100",children:[e.jsx("section",{className:"w-full md:w-3/5 p-6 sm:p-8 overflow-y-auto border-r border-slate-50",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-12 gap-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-[10px] uppercase font-black tracking-widest text-slate-300 pb-2 border-b border-slate-50",children:"Infrastructure"}),[{label:"Round",value:`${Math.min(s,U)} / ${U}`},{label:"Status",value:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:Oe}),e.jsx("span",{className:"font-bold",children:Ae})]})},{label:"Instance",value:`${he.name} (${pe}vCPU, ${me}GB)`},{label:"Stability",value:l?"‚Äî":e.jsxs("span",{className:`font-black ${Be}`,children:[E.toFixed(0),"%"]})},{label:"Total Crashes",value:re}].map((t,f)=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-400 text-[10px] font-bold uppercase",children:t.label}),e.jsx("div",{className:"text-xs font-bold text-slate-800",children:t.value})]},f))]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-[10px] uppercase font-black tracking-widest text-slate-300 pb-2 border-b border-slate-50",children:"Ops & Finance"}),[{label:"Active Users",value:Math.round(j)},{label:"Latency",value:l?"‚Äî":e.jsxs("span",{className:v>700?"text-rose-500 font-bold":"text-emerald-600",children:[v,"ms"]})},{label:"Utilization",value:l?"‚Äî":e.jsxs("span",{className:o>=.85?"text-rose-500 font-black":"text-emerald-500 font-bold",children:[(o*100).toFixed(0),"%"]})},{label:"User Mood",value:e.jsxs("div",{className:"flex items-center gap-2 font-black",children:[e.jsx("span",{children:De}),e.jsxs("span",{children:[(h*100).toFixed(0),"%"]})]})},{label:"Budget",value:e.jsxs("span",{className:"font-black text-indigo-600",children:["$",Math.round(y).toLocaleString()]})},{label:"Operating Cost",value:e.jsxs("span",{className:"text-rose-400 font-bold",children:["-$",fe,"/rd"]})}].map((t,f)=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-400 text-[10px] font-bold uppercase",children:t.label}),e.jsx("div",{className:"text-xs font-bold text-slate-800",children:t.value})]},f))]})]})}),e.jsxs("section",{className:"w-full md:w-2/5 bg-slate-50/50 p-6 flex flex-col items-center justify-center relative overflow-hidden",children:[e.jsx("h4",{className:"absolute top-6 left-6 text-[9px] uppercase font-black tracking-widest text-slate-300",children:"Live Stack"}),e.jsx("div",{className:`relative w-full max-w-[240px] p-1 rounded-[2rem] border-4 transition-all duration-700 shadow-xl ${m?"border-rose-200 bg-rose-50":q?"border-amber-200 bg-amber-50":"border-slate-200 bg-white"}`,children:e.jsxs("div",{className:"p-5 space-y-3",children:[e.jsxs("div",{className:`p-4 rounded-2xl border transition-all flex flex-col items-center gap-1 ${l?"bg-slate-100 text-slate-400 grayscale":"bg-indigo-50 border-indigo-100 text-indigo-600 shadow-sm"}`,children:[e.jsx("span",{className:"text-[10px] font-black uppercase",children:"Web App"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between text-[8px] font-bold mb-0.5 uppercase tracking-tighter opacity-70",children:[e.jsx("span",{children:"Resource Load"}),e.jsx("span",{children:l?"0%":`${(o*100).toFixed(0)}%`})]}),e.jsx("div",{className:"w-full bg-indigo-200 h-1 rounded-full overflow-hidden",children:e.jsx("div",{className:"bg-indigo-500 h-full transition-all duration-700",style:{width:l?"0%":`${o*100}%`}})})]})]}),e.jsxs("div",{className:`p-4 rounded-2xl border transition-all flex flex-col items-center gap-1 ${l?"bg-slate-100 text-slate-400 grayscale":"bg-emerald-50 border-emerald-100 text-emerald-600 shadow-sm"}`,children:[e.jsx("span",{className:"text-[10px] font-black uppercase",children:"Database"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between text-[8px] font-bold mb-0.5 uppercase tracking-tighter opacity-70",children:[e.jsx("span",{children:"Resource Load"}),e.jsx("span",{children:l?"0%":`${(Math.min(o*1.1,1)*100).toFixed(0)}%`})]}),e.jsx("div",{className:"w-full bg-emerald-200 h-1 rounded-full overflow-hidden",children:e.jsx("div",{className:"bg-emerald-500 h-full transition-all duration-700",style:{width:l?"0%":`${Math.min(o*1.1,1)*100}%`}})})]})]}),e.jsxs("div",{className:"pt-2 flex justify-between gap-1 text-[9px] font-bold text-slate-500",children:[e.jsxs("div",{className:"flex-1 bg-slate-100 p-1.5 rounded-lg text-center",children:[pe,"vCPU"]}),e.jsxs("div",{className:"flex-1 bg-slate-100 p-1.5 rounded-lg text-center",children:[me,"GB"]})]})]})}),e.jsx("p",{className:"mt-4 text-[9px] text-slate-400 font-bold text-center leading-tight uppercase tracking-widest",children:"Monolithic Topology"})]})]}),e.jsxs("footer",{className:"flex-shrink-0 h-40 p-4 sm:px-8 bg-slate-50",children:[e.jsx("h3",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2",children:"Event Stream"}),e.jsx("div",{className:"bg-white border border-slate-100 rounded-2xl h-[calc(100%-20px)] overflow-y-auto text-[10px] p-3 shadow-inner flex flex-col gap-1",children:G.length===0?e.jsx("div",{className:"p-4 text-slate-300 italic text-center font-bold",children:"Awaiting telemetry..."}):e.jsxs(e.Fragment,{children:[G.map((t,f)=>e.jsx("div",{className:`p-2 rounded-lg border-b border-transparent ${t.type==="crash"?"bg-rose-50 text-rose-800 font-bold":t.type==="downtime"?"bg-amber-50 text-amber-800":t.type==="warn"?"bg-orange-50 text-orange-900 font-bold":"bg-slate-50 text-slate-600"}`,children:t.text},f)),e.jsx("div",{ref:xe})]})})]})]})]})}_e.createRoot(document.getElementById("root")).render(e.jsx(Qe,{}));
